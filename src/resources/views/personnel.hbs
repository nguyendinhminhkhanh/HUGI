<body>
    <div id="wrapper">
        <div class="gray-bg">
            <div class="row border-bottom">
            </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>Quản lý nhân sự</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        <li>
                            <a>Quản trị viên</a>
                        </li>
                        <li class="active">
                            <strong>Quản lý nhân sự</strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2">
                </div>
            </div>
            <div class="wrapper wrapper-content animated fadeInRight">
                {{!-- <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Danh sách nhân sự</h5>
                                <div class="ibox-tools">
                                    <a class="collapse-link">
                                        <i class="fa fa-chevron-up"></i>
                                    </a>
                                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                        <i class="fa fa-wrench"></i>
                                    </a>
                                    <ul class="dropdown-menu dropdown-user">
                                        <li><a href="#">Config option 1</a>
                                        </li>
                                        <li><a href="#">Config option 2</a>
                                        </li>
                                    </ul>
                                    <a class="close-link">
                                        <i class="fa fa-times"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="ibox-content">

                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover dataTables-example">
                                        <thead>
                                            <tr>
                                                <th>Tên</th>
                                                <th>Chức vụ</th>
                                                <th>Số điện thoại</th>
                                                <th>Ngày sinh</th>
                                                <th>Ngày đăng kí</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="gradeU">
                                                <td>Other browsers</td>
                                                <td>All others</td>
                                                <td>-</td>
                                                <td class="center">-</td>
                                                <td class="center">U</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th>Rendering engine</th>
                                                <th>Browser</th>
                                                <th>Platform(s)</th>
                                                <th>Engine version</th>
                                                <th>CSS grade</th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>
                </div> --}}
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Danh sách nhân sự</h5>
                                <div class="ibox-tools">
                                    <a class="collapse-link">
                                        <i class="fa fa-chevron-up"></i>
                                    </a>
                                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                        <i class="fa fa-wrench"></i>
                                    </a>
                                    <ul class="dropdown-menu dropdown-user">
                                        <li><a href="#">Config option 1</a>
                                        </li>
                                        <li><a href="#">Config option 2</a>
                                        </li>
                                    </ul>
                                    <a class="close-link">
                                        <i class="fa fa-times"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="ibox-content">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <a class="btn btn-primary " href="/manager/personnel/form-add">Thêm nhân sự</a>
                                    </div>
                                    <div class="col-sm-6">
                                        <div id="editable_filter" class="dataTables_filter">
                                            <label style="display: flex;">
                                                <div style="text-align: center; margin:0.5rem">Search:</div>
                                                <input type="search" class="form-control input-sm" placeholder=""
                                                    aria-controls="editable">
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover " id="editable">
                                        <thead>
                                            <tr>
                                                <th>Họ và tên</th>
                                                <th>Avatar</th>
                                                <th>Chức vụ</th>
                                                <th>Số điện thoại</th>
                                                <th>Ngày sinh</th>
                                                <th>Ngày đăng kí</th>
                                                <th>Hành động</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {{#each person }}
                                            <tr class="gradeU">
                                                <td>{{this.name}}</td>
                                                <td>Avatar</td>
                                                <td>{{this.role}}</td>
                                                <td>{{this.phone}}</td>
                                                <td class="center">{{formatDate this.dob}}</td>
                                                <td class="center">{{formatDate this.createdAt}}</td>
                                                <td class="center">
                                                    <button data-toggle="modal" class="btn btn-primary  btn-delete"
                                                        data-id="{{this._id}}" href="#modal-form">Xoá</button>
                                                </td>
                                            </tr>
                                            {{/each}}
                                            <div id="modal-form" class="modal fade" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-body">
                                                            <h3 class="m-t-none m-b">Bạn có chắc muốn xóa không ? </h3>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-default"
                                                                    data-dismiss="modal">Đóng</button>
                                                                <button type="button" class="btn btn-primary"
                                                                    id="confirmDelete">Xóa</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-7">
                        <div class="dataTables_paginate paging_simple_numbers" id="editable_paginate">
                            <ul class="pagination">
                                <li class="paginate_button previous disabled" id="editable_previous"><a href="#"
                                        aria-controls="editable" data-dt-idx="0" tabindex="0">Previous</a></li>
                                <li class="paginate_button active"><a href="#" aria-controls="editable" data-dt-idx="1"
                                        tabindex="0">1</a></li>
                                <li class="paginate_button "><a href="#" aria-controls="editable" data-dt-idx="2"
                                        tabindex="0">2</a></li>
                                <li class="paginate_button "><a href="#" aria-controls="editable" data-dt-idx="3"
                                        tabindex="0">3</a></li>
                                <li class="paginate_button "><a href="#" aria-controls="editable" data-dt-idx="4"
                                        tabindex="0">4</a></li>
                                <li class="paginate_button "><a href="#" aria-controls="editable" data-dt-idx="5"
                                        tabindex="0">5</a></li>
                                <li class="paginate_button "><a href="#" aria-controls="editable" data-dt-idx="6"
                                        tabindex="0">6</a></li>
                                <li class="paginate_button next" id="editable_next"><a href="#" aria-controls="editable"
                                        data-dt-idx="7" tabindex="0">Next</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <div class="pull-right">
                    10GB of <strong>250GB</strong> Free.
                </div>
                <div>
                    <strong>Copyright</strong> Example Company &copy; 2014-2015
                </div>
            </div>

        </div>
    </div>


    <form name="delete-personnel-form" method="POST"></form>
</body>
<script>
    //logic xác nhận xoá
    document.addEventListener("DOMContentLoaded", function () {
        let deletePersonnelId = null;

        // Khi bấm nút "Xóa", lấy _id của sản phẩm
        document.querySelectorAll('.btn-delete').forEach(button => {
            button.addEventListener('click', function () {
                deletePersonnelId = this.getAttribute('data-id');
            });
        });

        // Khi bấm "Xóa" trong modal, gửi request xóa
        document.getElementById('confirmDelete').addEventListener('click', function () {
            if (deletePersonnelId) {
                // Tạo form ẩn để gửi yêu cầu xóa
                const deleteForm = document.createElement('form');
                deleteForm.method = 'POST';
                deleteForm.action = `/manager/personnel/${deletePersonnelId}?_method=DELETE`;

                document.body.appendChild(deleteForm);
                deleteForm.submit();
            }
        });
    });
</script>